
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>brainCloud Tests</title>


<link rel="stylesheet" href="./qunit-1.18.0.css" />
<script src="./jquery-1.12.4.js"></script>
<script src="./qunit-1.18.0.js"></script>
<script src="./md5.js"></script>


<script src="../src/brainCloudBase.js"></script>
<script src="../src/brainCloudClient.js"></script>
<script src="../src/brainCloudClient-authentication.js"></script>
<script src="../src/brainCloudClient-data-stream.js"></script>
<script src="../src/brainCloudClient-player-statistics.js"></script>
<script src="../src/brainCloudClient-entity.js"></script>
<script src="../src/brainCloudClient-globalentity.js"></script>
<script src="../src/brainCloudClient-products.js"></script>
<script src="../src/brainCloudClient-async-match.js"></script>
<script src="../src/brainCloudClient-push-notifications.js"></script>
<script src="../src/brainCloudClient-player-statistics-event.js"></script>
<script src="../src/brainCloudClient-global-app.js"></script>
<script src="../src/brainCloudClient-friend.js"></script>
<script src="../src/brainCloudClient-events.js"></script>
<script src="../src/brainCloudClient-gamification.js"></script>
<script src="../src/brainCloudClient-global-statistics.js"></script>
<script src="../src/brainCloudClient-match-making.js"></script>
<script src="../src/brainCloudClient-one-way-match.js"></script>
<script src="../src/brainCloudClient-playback-stream.js"></script>
<script src="../src/brainCloudClient-player-state.js"></script>
<script src="../src/brainCloudClient-profanity.js"></script>
<script src="../src/brainCloudClient-script.js"></script>
<script src="../src/brainCloudClient-social-leaderboards.js"></script>
<script src="../src/brainCloudClient-time.js"></script>
<script src="../src/brainCloudClient-tournament.js"></script>
<script src="../src/brainCloudClient-abtests.js"></script>
<script src="../src/brainCloudClient-global-app.js"></script>
<script src="../src/brainCloudClient-s3-handler.js"></script>
<script src="../src/brainCloudClient-identity.js"></script>
<script src="../src/brainCloudClient-redemption-code.js"></script>
<script src="../src/brainCloudClient-file.js"></script>
<script src="../src/brainCloudClient-group.js"></script>
<script src="../src/brainCloudClient-mail.js"></script>
<script src="../src/brainCloudWrapper.js"></script>

<script src="../src/brainCloudClient-reason-codes.js"></script>
<script src="../src/brainCloudClient-status-codes.js"></script>


<script type="text/javascript">
    var UserA = createUser("UserA", getRandomInt(0, 20000000));
    var UserB = createUser("UserB", getRandomInt(0, 20000000));

    var DEFAULT_TIMEOUT = 5000;

//TODO Add the Node based Unit Tests and File Loading Config Credentials
    var GAME_ID = "20001";
    var SECRET = "4e51b45c-030e-4f21-8457-dc53c9a0ed5f";
    var GAME_VERSION = "1.0.0";
    var SERVER_URL = "https://internal.braincloudservers.com";
    var PARENT_LEVEL_NAME = "Master";
    var CHILD_APP_ID = "20005";
    var PEER_NAME = "peerapp";

    var bc = new BrainCloudWrapper("PlayerOne");

    QUnit.config.reorder = false;

    function getRandomInt(min, max) {
        return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function createUser(prefix, randomId) {
        return {
            name : prefix + "-" + randomId,
            password : prefix + "-" + randomId,
            email : prefix + "-" + randomId + "@testuser.test",
            playerId : null
        };
    }

    ////////////////////////////////////////
    // Test Setup Functions
    ////////////////////////////////////////

    function initializeClient() {
        bc = new BrainCloudWrapper("PlayerOne");


        // we want to log debug messages
        bc.brainCloudClient.setDebugEnabled(true);

        //initialize with our game id, secret and game version
        bc.brainCloudClient.initialize(GAME_ID, SECRET, GAME_VERSION);

        // point to internal (default is sharedprod)
        bc.brainCloudClient.setServerUrl(SERVER_URL);

        bc.brainCloudClient.useJQuery(true);

        bc.brainCloudClient.authentication.clearSavedProfileId();
    }

    function setUpWithAuthenticate(userId, password) {
        initializeClient();

        initializeClient();
        var deferred = $.Deferred()

        var id = userId ? userId : UserA.name;
        var token = password ? password : UserA.password;

        deferred.then(null, null, function() {
            bc.brainCloudClient.authentication.authenticateUniversal(id,
                token, true, function(result)
                {
                    if(id == UserA.name) {
                        UserA.profileId = result["data"]["profileId"];
                    }
            		deferred.resolve();
                });
        });

        if(UserB.profileId == null)
        {
            bc.brainCloudClient.authentication.authenticateUniversal(UserB.name,
                UserB.password, true,
                function(result) {
                    UserB.profileId = result["data"]["profileId"];

                    bc.brainCloudClient.resetCommunication();

                    bc.brainCloudClient.brainCloudManager.resetCommunication();

                    deferred.notify();
                });
        }
        else deferred.notify();

        return deferred.promise();
    }

    function tearDownLogout() {
        var deferred = $.Deferred()

        if(bc.brainCloudClient.isAuthenticated()) {

            bc.playerState.logout (function () {

                bc.brainCloudClient.resetCommunication ();
                deferred.resolve ();
            });
            return deferred.promise ();
        } else {
            return deferred.promise ();
        }
    }

    ////////////////////////////////////////
    // Async match unit tests
    ////////////////////////////////////////
    function testKillSwitch() {
        module("Test Misc", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("testKillSwitch()", function() {
            var killSwitchCount = 0;

            while(killSwitchCount < 13) {

                bc.entity.updateEntity("bad_entity_id", {}, "failed", -1,
                    function(result) {

                    });

                killSwitchCount++;
            }

            setTimeout(function() {
                bc.brainCloudClient.authentication.authenticateAnonymous(
                true, function(result) {

                    equal(result.status, 900, JSON.stringify(result));
                    start();
                });
            }, 5000);
        });
    }


    function testAsyncMatch() {
        module("Async Match", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var platform = "BC";

        var matchId;

        asyncTest("createMatch()", function() {
            bc.asyncMatch.createMatch(
                	[ { "platform": platform, "id" : UserB.profileId }],
                	null,
                    function(result) {
                	    matchId = result["data"]["matchId"];
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("updateMatchSummaryData()", function() {
            bc.asyncMatch.updateMatchSummaryData(
                    UserA.profileId,
                	matchId,
                	0,
                	{"summary" : "sum"},
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("submitTurn()", function() {
            bc.asyncMatch.submitTurn(
                	UserA.profileId,
                	matchId,
                	1,
                	{"summary" : "sum"},
                	null,
                	UserB.profileId,
                	{"summary" : "sum"},
                	{"summary" : "sum"},
                    function(result) {
                	    matchId = result["data"]["matchId"];
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("abandonMatch()", function() {
            bc.asyncMatch.abandonMatch(
                    UserA.profileId,
                	matchId,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("deleteMatch()", function() {
            bc.asyncMatch.deleteMatch(
                    UserA.profileId,
                	matchId,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("createMatchWithInitialTurn()", function() {
            bc.asyncMatch.createMatchWithInitialTurn(
                	[ { "platform": platform, "id" : UserB.profileId }],
                	{ "matchStateData" : "test" },
                	null,
                	null,
                	{"summary" : "sum"},
                    function(result) {
                	    matchId = result["data"]["matchId"];
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("readMatch()", function() {
            bc.asyncMatch.readMatch(
                    UserA.profileId,
                	matchId,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("readMatchHistory()", function() {
            bc.asyncMatch.readMatchHistory(
                    UserA.profileId,
                	matchId,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("completeMatch()", function() {
            bc.asyncMatch.completeMatch(
                    UserA.profileId,
                	matchId,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("findMatches()", function() {
            bc.asyncMatch.findMatches(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("findCompleteMatches()", function() {
            bc.asyncMatch.findCompleteMatches(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });
    }

    ////////////////////////////////////////
    // Authentication tests
    ////////////////////////////////////////
    function testAuthentication() {
        module("Authentication", {
            beforeEach : initializeClient(),
            afterEach : tearDownLogout()
        });

        asyncTest("authenticateAnonymous()", function() {
            bc.brainCloudClient.authentication.generateNewAnonymousId();
            bc.brainCloudClient.authentication.clearSavedProfileId();

            bc.brainCloudClient.authentication.authenticateAnonymous(
                true, function(result) {
                    equal(result.status, 200, JSON.stringify(result));
                    start();
                });
        });


        asyncTest("authenticateUniversal()", function() {

            bc.brainCloudClient.authentication.generateNewAnonymousId();
            bc.brainCloudClient.authentication.clearSavedProfileId();

            bc.brainCloudClient.authentication.authenticateUniversal(UserA.name,
                    UserA.password, true, function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });


        asyncTest("resetEmailPassword()", function() {
            bc.brainCloudClient.authentication.resetEmailPassword(
                    "braincloudunittest@gmail.com",
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });
    }

	////////////////////////////////////////
    // DataStream unit tests
    ////////////////////////////////////////
    function testDataStream() {
        module("DataStream", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("customPageEvent()", function() {
            bc.dataStream.customPageEvent("testPage", {
                testProperty : "1"
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("customScreenEvent()", function() {
            bc.dataStream.customScreenEvent("testScreen", {
                testProperty : "1"
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("customTrackEvent()", function() {
            bc.dataStream.customTrackEvent("testTrack", {
                testProperty : "1"
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });
    }

    ////////////////////////////////////////
    // Entity unit tests
    ////////////////////////////////////////
    function testEntity() {
        module("Entity", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var entityId = "";
        var entityType = "BUILDING";

        asyncTest("createEntity()", function() {
            bc.entity.createEntity(entityType, {
                buildingName : "bob",
                buildingColour : "blue",
                buildingAddressNumber : 123,
                test : 1234
            }, { "other" : 2 }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                entityId = result.data.entityId;
                start();
            });
        });

        asyncTest("getEntity()", function() {
            bc.entity.getEntity(entityId, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("getEntitiesByType()", function() {
            bc.entity.getEntitiesByType(entityType, function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("updateEntity()", function() {
            bc.entity.updateEntity(entityId, "BUILDING2", {
                buildingName : "updatedName",
                buildingColour : "updatedColour"
            }, "", -1, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("updateSingleton()", function() {
            bc.entity.updateSingleton("MYSINGLETON", {
                name : "harry",
                age : 45
            }, null, -1, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("getSingleton()", function() {
            bc.entity.getSingleton("MYSINGLETON",
                function(result) {
                    equal(result.status, 200, JSON.stringify(result));
                    start();
            });
        });

        asyncTest("deleteSingleton()", function() {
            bc.entity.deleteSingleton("MYSINGLETON", -1,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("getSharedEntitiesForPlayerId()", function() {
        	bc.entity.getSharedEntitiesForPlayerId(
        	   UserA.profileId,
        	   function(result)
        	   {
        	       entityId = result["data"]["entities"][0]["entityId"];
        	       equal(result.status,200, JSON.stringify(result)); start();
        	   }
            );
        });

        asyncTest("getSharedEntitiesListForPlayerId()", function() {
            bc.entity.getSharedEntitiesListForPlayerId(
               UserA.profileId,
               { entityType: "test" },
               null,
               10,
               function(result)
               {
                   equal(result.status,200, JSON.stringify(result)); start();
               }
            );
        });

        asyncTest("getSharedEntitiesForPlayerId()", function() {
            bc.entity.getSharedEntitiesForPlayerId(
               UserA.profileId,
               function(result)
               {
                   entityId = result["data"]["entities"][0]["entityId"];
                   equal(result.status,200, JSON.stringify(result)); start();
               }
            );
        });

        asyncTest("updateSharedEntity()", function() {
        	bc.entity.updateSharedEntity(
        	   entityId,
        	   UserA.profileId,
        	   entityType,
        	   { "newData" : "new" },
        	   -1,
        	   function(result) {
                   equal(result.status, 200, JSON.stringify(result));
                   start();
           	});
        });

        asyncTest("incrementUserEntityData()", function() {
            bc.entity.incrementUserEntityData(
                entityId,
                { test : 234 },
                function(result) {
                    equal(result.status, 200, JSON.stringify(result));
                    start();
                });
        });

        asyncTest("incrementSharedUserEntityData()", function() {
            bc.entity.incrementSharedUserEntityData(
                entityId,
                UserA.profileId,
                { test : 234 },
                function(result) {
                    equal(result.status, 200, JSON.stringify(result));
                    start();
                });
        });

        asyncTest("deleteEntity()", function() {
            bc.entity.deleteEntity(entityId, -1,
                    function(result) { equal(result.status,200, JSON.stringify(result)); start(); });
        });

        asyncTest("getList()", function() {
            bc.entity.getList({
                "entityType" : "test"
            }, "", 50, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("getListCount()", function() {
            bc.entity.getListCount({
                "entityType" : "test"
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        var context = {
            pagination : {
                rowsPerPage : 50,
                pageNumber : 1
            },
            searchCriteria : {
                entityType : entityType
            }
        };
        var returnedContext;

        asyncTest("getPage()", function() {
            bc.entity.getPage(context, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                returnedContext = result["data"]["context"];
                start();
            });
        });

        asyncTest("getPageOffset()", function() {
            bc.entity.getPageOffset(returnedContext, 1,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        returnedContext = result["data"]["context"];
                        start();
                    });
        });
    }


    ////////////////////////////////////////
    // Event unit tests
    ////////////////////////////////////////
    function testEvent() {
        module("Event", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var eventType = "test";
        var eventDataKey = "testData";

        var eventId;

        asyncTest("sendEvent()", function() {
        	var sendEventSemi = 0;
        	bc.brainCloudClient.registerEventCallback(function() {
        		++sendEventSemi;
                if (sendEventSemi == 2) {
                	start();
                }
                equal(200, 200, "eventCallback");
                bc.brainCloudClient.deregisterEventCallback();
        	});
            bc.event.sendEvent(
                	UserA.profileId,
                	eventType,
                	{eventDataKey : 24 },
                    function(result) {
                	    eventId = result["data"]["evId"];
                        equal(result.status, 200, JSON.stringify(result));
                        ++sendEventSemi;
                        if (sendEventSemi == 2) {
                        	start();
                        }
                	});
        });

        asyncTest("updateIncomingEventData()", function() {
            bc.event.updateIncomingEventData(
                	eventId,
                	{eventDataKey : 117 },
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("deleteIncomingEvent()", function() {
            bc.event.deleteIncomingEvent(
                	eventId,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });

        asyncTest("getEvents()", function() {
            bc.event.getEvents(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	});
        });
    }

    ////////////////////////////////////////
    // Friend tests
    ////////////////////////////////////////
    function testFriend() {
        module("Friend", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("getProfileInfoForCredential()", 2, function() {
            bc.friend.getProfileInfoForCredential(
                    UserA.name, "Universal", function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getProfileInfoForExternalAuthId()", 2, function() {
            bc.friend.getProfileInfoForExternalAuthId(
                    "externalId", "Facebook", function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 400, "Expecting 400");
                        start();
                    });
        });

        asyncTest("getExternalIdForProfileId()", 2, function() {
            bc.friend.getExternalIdForProfileId(
                    UserA.profileId, "Facebook", function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getSummaryDataForProfileId()", 2, function() {
            bc.friend.getSummaryDataForProfileId(
                    UserA.profileId, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("findUsersByExactName()", 2, function() {
            bc.friend.findUsersByExactName("NotAUser", 10, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("findUsersBySubstrName()", 2, function() {
            bc.friend.findUsersBySubstrName("NotAUser", 10, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("findPlayerByUniversalId()", 2, function() {
            bc.friend.findPlayerByUniversalId("NotAUser", 10, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("addFriends()", 2, function() {
            var ids = [ UserB.profileId ];
            bc.friend.addFriends(ids, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("listFriends()", 2, function() {
            bc.friend.listFriends(bc.friend.friendPlatform.All, false,
                function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("removeFriends()", 2, function() {
            var ids = [ UserB.profileId ];
            bc.friend.removeFriends(ids, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("getUsersOnlineStatus()", 2, function() {
            var ids = [ UserB.profileId ];
            bc.friend.getUsersOnlineStatus(ids, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });
    }

    ////////////////////////////////////////
    // Gamification unit tests
    ////////////////////////////////////////
    function testGamification() {
        module("Gamification", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var achievementId1 = "testAchievements01";
        var achievementId2 = "testAchievements02";

        var userStatsCategory = "playerStats";
        var milestoneCategory = "Experience";
        var milestoneId = "2";

        var questsCategory = "Experience";

        asyncTest("awardAchievements()", function() {
            bc.gamification.awardAchievements(
                	[ achievementId1,achievementId2],
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                	},
                    true);
        });

        asyncTest("readAchievedAchievements()", function() {
            bc.gamification.readAchievedAchievements(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readAchievements()", function() {
            bc.gamification.readAchievements(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readCompletedMilestones()", function() {
            bc.gamification.readCompletedMilestones(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readInProgressMilestones()", function() {
            bc.gamification.readInProgressMilestones(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readMilestonesByCategory()", function() {
            bc.gamification.readMilestonesByCategory(
                    milestoneCategory,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("resetMilestones()", function() {
            bc.gamification.resetMilestones(
                    [ milestoneId ],
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("readCompletedQuests()", function() {
            bc.gamification.readCompletedQuests(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readNotStartedQuests()", function() {
            bc.gamification.readNotStartedQuests(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readInProgressQuests()", function() {
            bc.gamification.readInProgressQuests(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readQuests()", function() {
            bc.gamification.readQuests(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readQuestsByCategory()", function() {
            bc.gamification.readQuestsByCategory(
                    questsCategory,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readQuestsWithBasicPercentage()", function() {
            bc.gamification.readQuestsWithBasicPercentage(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readQuestsWithComplexPercentage()", function() {
            bc.gamification.readQuestsWithComplexPercentage(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readQuestsWithStatus()", function() {
            bc.gamification.readQuestsWithStatus(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readXPLevelsMetaData()", function() {
            bc.gamification.readXPLevelsMetaData(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("readAllGamification()", function() {
            bc.gamification.readAllGamification(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });

        asyncTest("readMilestones()", function() {
            bc.gamification.readMilestones(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    },
                    true);
        });
    }

    ////////////////////////////////////////
    // Global App unit tests
    ////////////////////////////////////////
    function testGlobalApp() {
        module("GlobalApp", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("readProperties()", function() {
            bc.globalApp.readProperties(
            function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });
    }

    ////////////////////////////////////////
    // GlobalStatistics unit tests
    ////////////////////////////////////////
    function testGlobalStatistics() {
        module("GlobalStatistics", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("incrementGlobalStats()", function() {
            bc.globalStatistics.incrementGlobalStats({
                "gamesPlayed" : 1,
                "gamesWon" : 1,
                "gamesLost" : 2
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("readAllGlobalStats()", function() {
            bc.globalStatistics.readAllGlobalStats(function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("readGlobalStatsSubset()", function() {
            bc.globalStatistics.readGlobalStatsSubset(
                    ["gamesPlayed"], function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("readGlobalStatsForCategory()", function() {
            bc.globalStatistics.readGlobalStatsForCategory(
                    "Test",
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("processStatistics()", function() {
            bc.globalStatistics.processStatistics({
                "gamesPlayed" : 1,
                "gamesWon" : 1,
                "gamesLost" : 2
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });
    }

    ////////////////////////////////////////
    // GlobalEntity unit tests
    ////////////////////////////////////////

    function testGlobalEntity() {
        module("Global Entity", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var entityId = "";
        var version = -1;
        var indexId = "12345";

        asyncTest("createEntity()", function() {
            bc.globalEntity.createEntity("BUILDING", 0, "", {
                buildingName : "bob",
                buildingColour : "blue",
                buildingAddressNumber : 123,
                test : 1234
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                entityId = result.data.entityId;
                version = result.data.version;
                start();
            });
        });

        asyncTest("updateEntity()", function() {
            bc.globalEntity.updateEntity(entityId, version, {
                buildingName : "bob",
                buildingColour : "blue",
                buildingAddressNumber : 123,
                test : 1234
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                version = result.data.version;
                start();
            });
        });

        asyncTest("incrementGlobalEntityData()", function() {
            bc.globalEntity.incrementGlobalEntityData(
            entityId,
            { test : 1234 },
            function(result) {
                equal(result.status, 200, JSON.stringify(result));
                version++;
                start();
            });
        });

        asyncTest("updateEntityAcl()", function() {
            bc.globalEntity.updateEntityAcl(entityId, {
                "other" : 2
            }, version, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                version = result.data.version;
                start();
            });
        });

        asyncTest("updateEntityUpdateTimeToLive()", function() {
            bc.globalEntity.updateEntityUpdateTimeToLive(
                    entityId, 100000, version, function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        version = result.data.version;
                        start();
                    });
        });

        asyncTest("readEntity()", function() {
            bc.globalEntity.readEntity(entityId,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        equal(result.data.version, version, "Result version "
                                + result.version + " cached " + version);
                        entityId = result.data.entityId;
                        start();
                    });
        });

        asyncTest("deleteEntity()", function() {
            bc.globalEntity.deleteEntity(entityId, version,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("createEntityWithIndexedId()", function() {
            bc.globalEntity.createEntityWithIndexedId("BUILDING",
                    indexId, 0, "", {
                        buildingName : "bob",
                        buildingColour : "blue",
                        buildingAddressNumber : 123
                    }, function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        entityId = result.data.entityId;
                        start();
                    });
        });

        asyncTest("getList()", function() {
            bc.globalEntity.getList({
                "data.buildName" : "bob"
            }, "", 50, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("getListByIndexedId()", function() {
            bc.globalEntity.getListByIndexedId(indexId, 50,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("getListCount()", function() {
            bc.globalEntity.getListCount({
                "data.buildName" : "bob"
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("updateEntityOwnerAndAcl()", function() {
            bc.globalEntity.updateEntityOwnerAndAcl(entityId, -1, UserA.profileId, { other: 2 },  function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("makeSystemEntity()", function() {
            bc.globalEntity.makeSystemEntity(entityId, -1, { other: 2 },  function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("deleteEntity()", function() {
            bc.globalEntity.deleteEntity(entityId, -1, function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        var context = {
            pagination : {
                rowsPerPage : 50,
                pageNumber : 1
            },
            searchCriteria : {
                entityType : "testGlobalEntity"
            }
        };
        var returnedContext;

        asyncTest("getPage()", function() {
            bc.globalEntity.getPage(context, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                returnedContext = result["data"]["context"];
                start();
            });
        });

        asyncTest("getPageOffset()", function() {
            bc.globalEntity.getPageOffset(returnedContext, 1,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        returnedContext = result["data"]["context"];
                        start();
                    });
        });
    }

    ////////////////////////////////////////
    // Group tests
    ////////////////////////////////////////
    function testGroup() {
        module("Group", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate(userToAuth.name, userToAuth.password).then(function() {
                    userToAuth = UserA;
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var userToAuth = UserA;
        var testData = { "test": 1234 };

        var groupId = "";
        var entityId = "";

        asyncTest("createGroup()", 2, function() {
            bc.group.createGroup("test",
                    "test",
                    false,
                    null,
                    null,
                    { test : "asdf"},
                    null,
                    function(result) {
                        groupId = result.data.groupId;
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("readGroupData()", 2, function() {
            bc.group.readGroupData(
                    groupId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("addGroupMember()", 2, function() {
            bc.group.addGroupMember(
                    groupId,
                    UserB.profileId,
                    bc.group.role.member,
                    null,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        userToAuth = UserB;
                        start();
                    });
        });

        asyncTest("leaveGroup()", 2, function() {
            bc.group.leaveGroup(
                    groupId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("inviteGroupMember()", 2, function() {
            bc.group.inviteGroupMember(
                    groupId,
                    UserB.profileId,
                    bc.group.role.member,
                    null,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("cancelGroupInvitation()", 2, function() {
            bc.group.cancelGroupInvitation(
                    groupId,
                    UserB.profileId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("inviteGroupMember()", 2, function() {
            bc.group.inviteGroupMember(
                    groupId,
                    UserB.profileId,
                    bc.group.role.member,
                    null,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        userToAuth = UserB;
                        start();
                    });
        });

        asyncTest("rejectGroupInvitation()", 2, function() {
            bc.group.rejectGroupInvitation(
                    groupId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("inviteGroupMember()", 2, function() {
            bc.group.inviteGroupMember(
                    groupId,
                    UserB.profileId,
                    bc.group.role.member,
                    null,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        userToAuth = UserB;
                        start();
                    });
        });

        asyncTest("acceptGroupInvitation()", 2, function() {
            bc.group.acceptGroupInvitation(
                    groupId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("removeGroupMember()", 2, function() {
            bc.group.removeGroupMember(
                    groupId,
                    UserB.profileId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        userToAuth = UserB;
                        start();
                    });
        });

        asyncTest("joinGroup()", 2, function() {
            bc.group.joinGroup(
                    groupId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("rejectGroupJoinRequest()", 2, function() {
            bc.group.rejectGroupJoinRequest(
                    groupId,
                    UserB.profileId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        userToAuth = UserB;
                        start();
                    });
        });

        asyncTest("joinGroup()", 2, function() {
            bc.group.joinGroup(
                    groupId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("approveGroupJoinRequest()", 2, function() {
            bc.group.approveGroupJoinRequest(
                    groupId,
                    UserB.profileId,
                    bc.group.role.member,
                    null,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("createGroupEntity()", 2, function() {
            bc.group.createGroupEntity(
                    groupId,
                    "test",
                    false,
                    null,
                    testData,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        entityId = result.data.entityId;
                        start();
                    });
        });

        asyncTest("readGroupEntity()", 2, function() {
            bc.group.readGroupEntity(
                    groupId,
                    entityId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("updateGroupEntityData()", 2, function() {
            bc.group.updateGroupEntityData(
                    groupId,
                    entityId,
                    1,
                    testData,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("incrementGroupEntityData()", 2, function() {
            bc.group.incrementGroupEntityData(
                    groupId,
                    entityId,
                    testData,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("deleteGroupEntity()", 2, function() {
            bc.group.deleteGroupEntity(
                    groupId,
                    entityId,
                    -1,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        var entityContext = {
            pagination : {
                rowsPerPage : 50,
                pageNumber : 1
            },
            searchCriteria : {
                groupId : groupId,
                entityType : "test"
            }
        };
        var entityReturnedContext;

        asyncTest("readGroupEntitiesPage()", 2, function() {
            entityContext.searchCriteria.groupId = groupId;
            bc.group.readGroupEntitiesPage(
                    entityContext,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        entityReturnedContext = result.data.context;
                        start();
                    });
        });

        asyncTest("readGroupEntitiesPageByOffset()", 2, function() {
            bc.group.readGroupEntitiesPageByOffset(
                    entityReturnedContext,
                    1,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("updateGroupData()", 2, function() {
            bc.group.updateGroupData(
                    groupId,
                    -1,
                    testData,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("incrementGroupData()", 2, function() {
            bc.group.incrementGroupData(
                    groupId,
                    testData,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("updateGroupName()", 2, function() {
            bc.group.updateGroupName(
                    groupId,
                    "testName",
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getMyGroups()", 2, function() {
            bc.group.getMyGroups(
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("listGroupsWithMember()", 2, function() {
            bc.group.listGroupsWithMember(
                UserA.profileId,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        var groupContext = {
            pagination : {
                rowsPerPage : 50,
                pageNumber : 1
            },
            searchCriteria : {
                groupType : "test"
            }
        };
        var groupReturnedContext;

        asyncTest("listGroupsPage()", 2, function() {
            bc.group.listGroupsPage(
                    groupContext,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        groupReturnedContext = result.data.context;
                        start();
                    });
        });

        asyncTest("listGroupsPageByOffset()", 2, function() {
            bc.group.listGroupsPageByOffset(
                    groupReturnedContext,
                    1,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("readGroup()", 2, function() {
            bc.group.readGroup(
                    groupId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("readGroupMembers()", 2, function() {
            bc.group.readGroupMembers(
                    groupId,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("updateGroupMember()", 2, function() {
            bc.group.updateGroupMember(
                    groupId,
                    UserA.profileId,
                    null,
                    null,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("deleteGroup()", 2, function() {
            bc.group.deleteGroup(
                    groupId,
                    -1,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("createGroup()", 2, function() {
            bc.group.createGroup("test",
                    "test",
                    false,
                    null,
                    null,
                    { test : "asdf"},
                    null,
                    function(result) {
                        groupId = result.data.groupId;
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        userToAuth = UserB;
                        start();
                    });
        });

        asyncTest("autoJoinGroup()", 2, function() {
            bc.group.autoJoinGroup("test",
                    bc.group.autoJoinStrategy.joinFirstGroup,
                    null,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("deleteGroup()", 2, function() {
            bc.group.deleteGroup(
                    groupId,
                    -1,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });
    }

    ////////////////////////////////////////
    // Identity tests
    ////////////////////////////////////////
    function testIdentity() {
        module("Identity", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("attachFacebookId()", 2, function() {
            bc.identity.attachFacebookIdentity("test",
                    "3780516b-14f8-4055-8899-8eaab6ac7e82", function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 403, "Expecting 403");
                        start();
                    });
        });

        asyncTest("mergeFacebookId()", 2, function() {
            bc.identity.mergeFacebookIdentity("test",
                    "3780516b-14f8-4055-8899-8eaab6ac7e82", function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 202, "Expecting 202");
                        start();
                    });
        });

        asyncTest("detachFacebookId()", 2, function() {
            bc.identity.detachFacebookIdentity("test", true,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 202, "Expecting 202");
                        start();
                    });
        });

        asyncTest("getIdentities()", 2, function() {
            bc.identity.getIdentities(
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getExpiredIdentities()", 2, function() {
            bc.identity.getExpiredIdentities(
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("refreshIdentity()", 3, function() {
            bc.identity.refreshIdentity(
                    UserA.name,
                    UserA.password,
                    bc.identity.authenticationType.universal,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 400, "Expecting 400");
                        equal(result.reason_code, 40464, "Expecting 40464");
                        start();
                    });
        });

        asyncTest("attachEmailIdentity()", 2, function() {
            bc.identity.attachEmailIdentity(UserA.email, 
                UserA.password,
                function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("changeEmailIdentity()", 2, function() {

            let newEmail = "test_" + getRandomInt(0,1000000) + "@bitheads.com";
            
            bc.identity.changeEmailIdentity(
                    UserA.email,
                    UserA.password,
                    newEmail,
                    true,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
                    
        });
    }


    ////////////////////////////////////////
    // Mail tests
    ////////////////////////////////////////
    function testMail() {
        module("Mail", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("updateContactEmail()", 2, function() {
            bc.playerState.updateContactEmail(
                "braincloudunittest@gmail.com",
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("sendBasicEmail()", 2, function() {
            bc.mail.sendBasicEmail(
                UserA.profileId,
                "Test Subject - TestSendBasicEmail",
                "Test body content message.",
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("sendAdvancedEmail()", 2, function() {
            bc.mail.sendAdvancedEmail(
                UserA.profileId, {
                    subject: "Test Subject - TestSendAdvancedEmailSendGrid",
                    body: "Test body content message.",
                    categories: [ "unit-test" ]
                },
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("sendAdvancedEmailByAddress()", 2, function() {
            bc.mail.sendAdvancedEmailByAddress(
                UserA.email, {
                    subject: "Test Subject - TestSendAdvancedEmailSendGrid",
                    body: "Test body content message.",
                    categories: [ "unit-test" ]
                },
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

    }


	////////////////////////////////////////
    // Matchmaking tests
    ////////////////////////////////////////
    function testMatchMaking() {
        module("MatchMaking", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("disableMatchMaking()", 2, function() {
            bc.matchMaking.disableMatchMaking(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("enableMatchMaking()", 2, function() {
            bc.matchMaking.enableMatchMaking(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("read()", 2, function() {
            bc.matchMaking.read(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("setPlayerRating()", 2, function() {
            bc.matchMaking.setPlayerRating(150, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("resetPlayerRating()", 2, function() {
            bc.matchMaking.resetPlayerRating(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("incrementPlayerRating()", 2, function() {
            bc.matchMaking.incrementPlayerRating(25, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("decrementPlayerRating()", 2, function() {
            bc.matchMaking.decrementPlayerRating(25, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("turnShieldOn()", 2, function() {
            bc.matchMaking.turnShieldOn(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("turnShieldOff()", 2, function() {
            bc.matchMaking.turnShieldOff(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("turnShieldOnFor()", 2, function() {
            bc.matchMaking.turnShieldOnFor(60, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("incrementShieldOnFor()", 2, function() {
            bc.matchMaking.incrementShieldOnFor(60, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("findPlayers()", 2, function() {
            bc.matchMaking.findPlayers(100, 5, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("findPlayersWithAttributes()", 2, function() {
            bc.matchMaking.findPlayersWithAttributes(100, 5,
                { test : "test" },
                function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("getShieldExpiry()", 2, function() {
            bc.matchMaking.getShieldExpiry(UserB.profileId, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("findPlayersUsingFilter()", 2, function() {
            bc.matchMaking.findPlayersUsingFilter(100, 5, {
                test : "test"
            }, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("findPlayersWithAttributesUsingFilter()", 2, function() {
            bc.matchMaking.findPlayersWithAttributesUsingFilter(100, 5,
                { test : "test" }, { test : "test" },
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
            });
        });
    }

    ////////////////////////////////////////
    // One Way Match tests
    ////////////////////////////////////////
    function testOneWayMatch() {
        module("One Way Match", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var streamId;

        asyncTest("startMatch()", 2, function() {
            bc.oneWayMatch.startMatch(
                    UserB.profileId,
                    1000,
                    function(result) {
                    streamId = result["data"]["playbackStreamId"];
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("cancelMatch()", 2, function() {
            bc.oneWayMatch.cancelMatch(
                    streamId,
                    function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("startMatch()", 2, function() {
            bc.oneWayMatch.startMatch(
                    UserB.profileId,
                    1000,
                    function(result) {
                    streamId = result["data"]["playbackStreamId"];
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("completeMatch()", 2, function() {
            bc.oneWayMatch.completeMatch(
                    streamId,
                    function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });
    }

    ////////////////////////////////////////
    // Playback Stream tests
    ////////////////////////////////////////
    function testPlaybackStream() {
        module("Playback Stream", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var streamId;

        asyncTest("startStream()", 2, function() {
            bc.playbackStream.startStream(
                    UserB.profileId,
                    true,
                    function(result) {
                    streamId = result["data"]["playbackStreamId"];
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("addEvent()", 2, function() {
            bc.playbackStream.addEvent(
                    streamId,
                    { "data" : 10 },
                    { "summary" : 10 },
                    function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("getStreamSummariesForTargetPlayer()", 2, function() {
            bc.playbackStream.getStreamSummariesForTargetPlayer(
                    streamId,
                    function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("getStreamSummariesForInitiatingPlayer()", 2, function() {
            bc.playbackStream.getStreamSummariesForInitiatingPlayer(
                    streamId,
                    function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("readStream()", 2, function() {
            bc.playbackStream.readStream(
                    streamId,
                    function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("endStream()", 2, function() {
            bc.playbackStream.endStream(
                    streamId,
                    function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("startStream()", 2, function() {
            bc.playbackStream.startStream(
                    UserB.profileId,
                    true,
                    function(result) {
                    streamId = result["data"]["playbackStreamId"];
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("deleteStream()", 2, function() {
            bc.playbackStream.deleteStream(
                    streamId,
                    function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });
    }

    ////////////////////////////////////////
    // Player State tests
    ////////////////////////////////////////
    function testPlayerState() {
        module("PlayerState (No Logout)", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            }
        });

        asyncTest("deletePlayer()", function() {
            bc.playerState.deletePlayer(function(result) {
                equal(result.status, 200, JSON.stringify(result));
                bc.brainCloudClient.resetCommunication();
                start();
            });
        });

        module("PlayerState", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("updatePlayerName()", function() {
            bc.playerState.updatePlayerName("junit", function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("readPlayerState()", function() {
            bc.playerState.readPlayerState(function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("updateAttributes()", 1, function() {
            bc.playerState.updateAttributes({
                "att1" : "123",
                "att2" : "blue"
            }, true, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("getAttributes()", 2, function() {
            bc.playerState.getAttributes(function(result) {
                equal(result.status, 200, JSON.stringify(result));
                equal(result.data.attributes.att2, "blue",
                        "Attribute comparison");
                start();
            });
        });

        asyncTest("removeAttributes()", function() {
            bc.playerState.removeAttributes(["att1", "att2"],
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("updateSummaryFriendData()", 2, function() {
            bc.playerState.updateSummaryFriendData({"field":"value"}, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("updatePlayerPictureUrl()", 2, function() {
            bc.playerState.updatePlayerPictureUrl("https://some.domain.com/mypicture.jpg", function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("updateContactEmail()", 2, function() {
            bc.playerState.updateContactEmail("something@bctestdomain.com", function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("resetPlayer()", function() {
            bc.playerState.resetPlayer(
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });
    }

    ////////////////////////////////////////
    // Player Statistics Event tests
    ////////////////////////////////////////
    function testPlayerStatisticsEvent() {
        module("Player Statistics Event", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var eventId1 = "testEvent01";
        var eventId2 = "rewardCredits";

        asyncTest("triggerPlayerStatisticsEvent()", 2, function() {
            bc.playerStatisticsEvent.triggerPlayerStatisticsEvent(
                    eventId1,
                    10,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });


    	asyncTest("triggerPlayerStatisticsEvents()", 2, function() {
            bc.playerStatisticsEvent.triggerPlayerStatisticsEvents(
                    [
                        { "eventName" : eventId1, "eventMultiplier" : 10 },
                        { "eventName" : eventId2, "eventMultiplier" : 10 }
                    ],
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });


    	asyncTest("rewardHandlerTriggerStatisticsEvents()", function() {
    		bc.playerState.resetPlayer();

    		var rewardCallbackCount = 0;
    		bc.brainCloudClient.registerRewardCallback(function(rewardsJson)
    			{
    				++rewardCallbackCount;
    				ok(true, JSON.stringify(rewardsJson));
                    start();
                    bc.brainCloudClient.deregisterRewardCallback();
    			})
            bc.playerStatisticsEvent.triggerPlayerStatisticsEvents(
                    [
                        { "eventName" : "incQuest1Stat", "eventMultiplier" : 1 },
                        { "eventName" : "incQuest2Stat", "eventMultiplier" : 1 }
                    ],
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                    });

        });
    }

    ////////////////////////////////////////
    // PlayerStatistics unit tests
    ////////////////////////////////////////
    function testPlayerStatistics() {

        module("PlayerStatistics", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("getNextExperienceLevel()", function() {
            bc.playerStatistics.getNextExperienceLevel(function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("incrementExperiencePoints()", function() {
            bc.playerStatistics.incrementExperiencePoints(100,
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("incrementPlayerStats()", function() {
            bc.playerStatistics.incrementPlayerStats({
                "wins" : 10,
                "losses" : 4
            }, 100, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("readAllPlayerStats()", function() {
            bc.playerStatistics.readAllPlayerStats(function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("readPlayerStatsSubset()", function() {
            bc.playerStatistics.readPlayerStatsSubset(["wins"],
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("readPlayerStatsForCategory()", function() {
            bc.playerStatistics.readPlayerStatsForCategory(
                    "Test",
                    function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("resetAllPlayerStats()", function() {
            bc.playerStatistics.resetAllPlayerStats(function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("setExperiencePoints()", function() {
            bc.playerStatistics.setExperiencePoints(50, function(
                    result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });

        asyncTest("processStatistics()", function() {
            bc.playerStatistics.processStatistics({
                "gamesPlayed" : 1,
                "gamesWon" : 1,
                "gamesLost" : 2
            }, function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });
    }

    ////////////////////////////////////////
    // Product unit tests
    ////////////////////////////////////////
    function testProduct() {
        module("Product", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var currencyType = "credits";
        var platform = "windows";
        var productCatagory = "Test";

        asyncTest("awardCurrency()", 2, function() {
            bc.product.awardCurrency(currencyType, 200, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 403, "Expecting 403");
                start();
            });
        });

        asyncTest("consumeCurrency()", 2, function() {
            bc.product.consumeCurrency(currencyType, 100,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 403, "Expecting 403");
                        start();
                    });
        });

        asyncTest("getCurrency()", 2, function() {
            bc.product.getCurrency(currencyType,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getEligiblePromotions()", 2, function() {
            bc.product.getEligiblePromotions(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("getSalesInventory()", 2, function() {
            bc.product.getSalesInventory(platform, currencyType,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getSalesInventoryByCategory()", 2, function() {
            bc.product.getSalesInventoryByCategory(platform,
                    currencyType, productCatagory, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("resetCurrency()", 2, function() {
            bc.product.resetCurrency(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 403, "Expecting 403");
                start();
            });
        });
    }

    ////////////////////////////////////////
    // Profanity unit tests
    ////////////////////////////////////////
    function testProfanity() {
        module("Profanity", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("profanityCheck()", 2, function() {
            bc.profanity.profanityCheck("shitbird fly away", "en", true, true, true, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("profanityReplaceText()", 2, function() {
            bc.profanity.profanityReplaceText("shitbird fly away", "*", "en", false, false, false, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("profanityIdentifyBadWords()", 2, function() {
            bc.profanity.profanityIdentifyBadWords("shitbird fly away", "en,fr", true, false, false, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });
    }


    ////////////////////////////////////////
    // Push notification unit tests
    ////////////////////////////////////////
    function testPushNotification() {
        module("Push Notification", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("deregisterAllPushNotificationDeviceTokens()", 2, function() {
            bc.pushNotification.deregisterAllPushNotificationDeviceTokens(function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("registerPushNotificationToken()", 2, function() {
            bc.pushNotification.registerPushNotificationToken("IOS", "GARBAGE_TOKEN", function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("deregisterPushNotificationDeviceToken()", 2, function() {
            bc.pushNotification.deregisterPushNotificationDeviceToken("IOS", "GARBAGE_TOKEN", function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("sendSimplePushNotification()", 2, function() {
            bc.pushNotification.sendSimplePushNotification(
                    UserA.profileId,
                    "Test message.",
                    function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("sendRichPushNotification()", 2, function() {
            bc.pushNotification.sendRichPushNotification(
                    UserA.profileId,
                    1,
                    function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("sendRichPushNotificationWithParams()", 2, function() {
            bc.pushNotification.sendRichPushNotificationWithParams(
                    UserA.profileId,
                    1,
                    { "1" : UserA.name },
                    function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        var groupId = "";

        asyncTest("createGroup()", 2, function() {
            bc.group.createGroup("test",
                    "test",
                    false,
                    null,
                    null,
                    { test : "asdf"},
                    null,
                    function(result) {
                        groupId = result.data.groupId;
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("sendTemplatedPushNotificationToGroup()", 2, function() {
            bc.pushNotification.sendTemplatedPushNotificationToGroup(
                groupId,
                1,
                { "1" : UserA.name },
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("sendNormalizedPushNotificationToGroup()", 2, function() {
            bc.pushNotification.sendNormalizedPushNotificationToGroup(
                groupId,
                { body: "content of message", title: "message title" },
                null,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

		asyncTest("scheduleNormalizedPushNotificationUTC()", 2, function() {
            bc.pushNotification.scheduleNormalizedPushNotificationUTC(
                    UserA.profileId,
                    { body: "content of message", title: "message title" },
					null,
					0,
                    function(result) {
						ok(true, JSON.stringify(result));
						equal(result.status, 200, "Expecting 200");
						start();
            });
        });

		asyncTest("scheduleNormalizedPushNotificationMinutes()", 2, function() {
            bc.pushNotification.scheduleNormalizedPushNotificationMinutes(
                    UserA.profileId,
                    { body: "content of message", title: "message title" },
					null,
					42,
                    function(result) {
						ok(true, JSON.stringify(result));
						equal(result.status, 200, "Expecting 200");
						start();
            });
        });

		asyncTest("scheduleRichPushNotificationUTC()", 2, function() {
            bc.pushNotification.scheduleRichPushNotificationUTC(
                    UserA.profileId,
                    1,
                    { "1" : UserA.name },
					0,
                    function(result) {
						ok(true, JSON.stringify(result));
						equal(result.status, 200, "Expecting 200");
						start();
            });
        });

		asyncTest("scheduleRichPushNotificationMinutes()", 2, function() {
            bc.pushNotification.scheduleRichPushNotificationMinutes(
                    UserA.profileId,
                    1,
                    { "1" : UserA.name },
					42,
                    function(result) {
						ok(true, JSON.stringify(result));
						equal(result.status, 200, "Expecting 200");
						start();
            });
        });

        asyncTest("deleteGroup()", 2, function() {
            bc.group.deleteGroup(
                groupId,
                -1,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("sendNormalizedPushNotification()", 2, function() {
            bc.pushNotification.sendNormalizedPushNotification(
                UserB.profileId,
                { body: "content of message", title: "message title" },
                null,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("sendNormalizedPushNotificationBatch()", 2, function() {
            bc.pushNotification.sendNormalizedPushNotificationBatch(
                [ UserA.profileId, UserB.profileId ],
                { body: "content of message", title: "message title" },
                null,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });
    }

    ////////////////////////////////////////
    // Redemption Code unit tests
    ////////////////////////////////////////
    function testRedemptionCode() {
        module("Redemption Code", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var _lastCodeUsedStatName = "lastCodeUsed";
        var _codeType = "default";
        var _codeToRedeem = "";

        asyncTest("getCodeToRedeem()", 2, function() {
            bc.globalStatistics.incrementGlobalStats(
                {
                    lastCodeUsed : "+1"
                },
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    _codeToRedeem = result.data.statistics.lastCodeUsed.toString();
                    start();
                }
            );
        });

        asyncTest("redeemCode()", 2, function() {
            bc.redemptionCode.redeemCode(_codeToRedeem, _codeType, null,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("getRedeemedCodes()", 2, function() {
            bc.redemptionCode.getRedeemedCodes(_codeType,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });
    }

    ////////////////////////////////////////
    // S3 Handling tests
    ////////////////////////////////////////
    function testS3Handling() {
        module("S3 Handling", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("getUpdatedFiles()", 2, function() {
            bc.s3Handling.getUpdatedFiles("test", [{
                "fileId" : "3780516b-14f8-4055-8899-8eaab6ac7e82"
            }], function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        var fileId = "";

        asyncTest("getFileList()", 2, function() {
            bc.s3Handling.getFileList("test", function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");

                fileId = result.data.fileDetails[0].fileId;
                start();
            });
        });

        asyncTest("getCDNUrl()", 2, function() {
            bc.s3Handling.getCDNUrl(
                fileId, function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });
    }

    ////////////////////////////////////////
    // Script tests
    ////////////////////////////////////////
    function testScript() {
        module("Script", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var scriptName = "testScript";
        var peerScriptName = "TestPeerScriptPublic";
        var scriptData = {
            testParam1 : 1
        };

        asyncTest("runScript()", 2, function() {
            bc.script.runScript(scriptName, scriptData, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("scheduleRunScriptUTC()", 2, function() {

            var today = new Date();
            var tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);

            bc.script.scheduleRunScriptUTC(scriptName,
                    scriptData, tomorrow, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        var jobId = "";

        asyncTest("scheduleRunScriptMinutes()", 2, function() {
            bc.script.scheduleRunScriptMinutes(scriptName,
                    scriptData, 60, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");

                        jobId = result.data.jobId;
                        start();
                    });
        });

        asyncTest("cancelScheduledScript()", 2, function() {
            bc.script.cancelScheduledScript(
                jobId, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("attachPeerProfile()", 2, function() {
            bc.identity.attachPeerProfile(
                PEER_NAME, UserA.name, UserA.password,
                bc.identity.authenticationType.universal,
                 null, true,
                function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("runPeerScript()", 2, function() {
            bc.script.runPeerScript(peerScriptName, scriptData, PEER_NAME, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("runPeerScriptAsync()", 2, function() {
            bc.script.runPeerScriptAsync(peerScriptName, scriptData, PEER_NAME, function(
                    result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("detachPeer()", 2, function() {
            bc.identity.detachPeer(
                PEER_NAME,
                function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });
    }

    ////////////////////////////////////////
    // SocialLeaderboard unit tests
    ////////////////////////////////////////
    function testSocialLeaderboard() {
        module("SocialLeaderboard", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var leaderboardName = "testLeaderboard";

        asyncTest("getGlobalLeaderboardPage()", 2, function() {
            bc.socialLeaderboard.getGlobalLeaderboardPage(
                    leaderboardName,
                    bc.socialLeaderboard.sortOrder.HIGH_TO_LOW,
                    0, 10, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getGlobalLeaderboardView()", 2, function() {
            bc.socialLeaderboard.getGlobalLeaderboardView(
                    leaderboardName,
                    bc.socialLeaderboard.sortOrder.HIGH_TO_LOW,
                    4, 5, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        var versionId = 0;

        asyncTest("getGlobalLeaderboardVersions()", 2, function() {
            bc.socialLeaderboard.getGlobalLeaderboardVersions(
                    leaderboardName, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        if (result.data.versions.length > 0) {
                            versionId = result.data.versions[0].versionId;
                        }
                        start();
                    });
        });

        asyncTest(
                "getGlobalLeaderboardPageByVersion()",
                2,
                function() {
                    bc.socialLeaderboard
                            .getGlobalLeaderboardPageByVersion(
                                    leaderboardName,
                                    bc.socialLeaderboard.sortOrder.HIGH_TO_LOW,
                                    0, 10, versionId, function(result) {
                                        ok(true, JSON.stringify(result));
                                        equal(result.status, 200,
                                                "Expecting 200");
                                        start();
                                    });
                });

        asyncTest("getGlobalLeaderboardViewByVersion()", 2, function() {
            bc.socialLeaderboard
                    .getGlobalLeaderboardViewByVersion(
                            leaderboardName,
                            bc.socialLeaderboard.sortOrder.HIGH_TO_LOW,
                            4, 5, versionId, function(result) {
                                ok(true, JSON.stringify(result));
                                equal(result.status, 200,
                                        "Expecting 200");
                                start();
                            });
        });

        asyncTest("getGlobalLeaderboardEntryCount()", 2, function() {
            bc.socialLeaderboard.getGlobalLeaderboardEntryCount(
                    leaderboardName, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("postScoreToDynamicLeaderboard()", 2, function() {
            var today = new Date();
            var tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);

            bc.socialLeaderboard.postScoreToDynamicLeaderboard(
                    "testDynamicJs" + (Math.random() * 10000000).toFixed(0), 1000, {
                        "extra" : 123
                    },  bc.socialLeaderboard.leaderboardType.HIGH_VALUE,
                        bc.socialLeaderboard.rotationType.DAILY, tomorrow,
                    3, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("postScoreToDynamicLeaderboardDays()", 2, function() {
            var today = new Date();
            var tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);

            bc.socialLeaderboard.postScoreToDynamicLeaderboardDays(
                    "testDynamicJsDays" + (Math.random() * 10000000).toFixed(0), 1000, {
                        "extra" : 123
                    },  bc.socialLeaderboard.leaderboardType.HIGH_VALUE, tomorrow,
                    3, 3, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("postScoreToLeaderboard()", 2, function() {
            bc.socialLeaderboard.postScoreToLeaderboard(
                    leaderboardName, 1000, {
                        "extra" : 123
                    }, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getSocialLeaderboard()", 2, function() {
            bc.socialLeaderboard.getSocialLeaderboard(leaderboardName,
                    true, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getMultiSocialLeaderboard()", 2, function() {
            bc.socialLeaderboard.getMultiSocialLeaderboard(
            		[ leaderboardName, "testDynamicJs" ],
            		10,
                    true, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("listAllLeaderboards()", 2, function() {
            bc.socialLeaderboard.listAllLeaderboards(
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        var groupId = "";

        asyncTest("createGroup()", 2, function() {
            bc.group.createGroup("test",
                    "test",
                    false,
                    null,
                    null,
                    { test : "asdf"},
                    null,
                    function(result) {
                        groupId = result.data.groupId;
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getGroupSocialLeaderboard()", 2, function() {
            bc.socialLeaderboard.getGroupSocialLeaderboard(
                leaderboardName,
                groupId,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("deleteGroup()", 2, function() {
            bc.group.deleteGroup(
                groupId,
                -1,
                function(result) {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                });
        });

        asyncTest("getPlayersSocialLeaderboard()", 2, function() {
            bc.socialLeaderboard.getPlayersSocialLeaderboard(
                    leaderboardName,
                    [ UserA.profileId, UserB.profileId ],
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getPlayerScore()", 2, function() {
            bc.socialLeaderboard.getPlayerScore(
                    leaderboardName,
                    -1,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getPlayerScoresFromLeaderboards()", 2, function() {
            bc.socialLeaderboard.getPlayerScoresFromLeaderboards(
                    [ leaderboardName ],
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("removePlayerScore()", 2, function() {
            bc.socialLeaderboard.removePlayerScore(
                    leaderboardName,
                    -1,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });
    }

    ////////////////////////////////////////
    // Time unit tests
    ////////////////////////////////////////
    function testTime() {
        module("Time", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        asyncTest("readServerTime()", 2, function() {
            bc.time.readServerTime(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });
    }

    ////////////////////////////////////////
    // Tournament unit tests
    ////////////////////////////////////////
    function testTournament() {
        module("Tournament", {
            beforeEach : function() {
                stop();
                setUpWithAuthenticate().then(function() {
                    start()
                });
            },
            afterEach : function() {
                stop();
                tearDownLogout().then(function() {
                    start()
                });
            }
        });

        var _tournamentCode = "testTournament";
        var _leaderboardId = "testTournamentLeaderboard";
        var _version = 0;

        asyncTest("joinTournament()", 2, function() {
            bc.tournament.joinTournament(
            _leaderboardId,
            _tournamentCode,
            0,
            function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("getTournamentStatus()", 2, function() {
            bc.tournament.getTournamentStatus(
            _leaderboardId,
            -1,
            function(result) {
                ok(true, JSON.stringify(result));
                _version = result.data.versionId;
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("claimTournamentReward()", 2, function() {
            bc.tournament.claimTournamentReward(
            _leaderboardId,
            -1,
            function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 400, "Expecting 400");
                start();
            });
        });

        asyncTest("postTournamentScore()", 2, function() {
            bc.tournament.postTournamentScore(
            _leaderboardId,
            200,
            { "test" : "test" },
            new Date(),
            function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("postTournamentScoreWithResults()", 2, function() {
            bc.tournament.postTournamentScoreWithResults(
            _leaderboardId,
            200,
            { "test" : "test" },
            new Date(),
            bc.socialLeaderboard.sortOrder.HIGH_TO_LOW,
            10,
            10,
            0,
            function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("viewCurrentReward()", 2, function() {
            bc.tournament.viewCurrentReward(
            _leaderboardId,
            function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("viewReward()", 2, function() {
            bc.tournament.viewReward(
            _leaderboardId,
            -1,
            function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 400, "Expecting 400");
                start();
            });
        });

        asyncTest("leaveTournament()", 2, function() {
            bc.tournament.leaveTournament(
            _leaderboardId,
            function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });
    }

    ////////////////////////////////////////
    // Shared identity unit tests
    ////////////////////////////////////////
    function testSharedIdentity() {
        module("Shared Identity", null);

        var currencyType = "credits";
        var scriptName = "testScript";
        var scriptData = { "testParam1" : 1 };

        asyncTest("authenticateUniversal()", function() {
            bc.brainCloudClient.authentication.authenticateUniversal(UserA.name,
                    UserA.password, true, function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("switchToChildProfile()", 2, function() {
            bc.identity.switchToChildProfile(null,
                    CHILD_APP_ID,
                    true,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("switchToParentProfile()", 2, function() {
            bc.identity.switchToParentProfile(PARENT_LEVEL_NAME,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getChildProfiles()", 2, function() {
            bc.identity.getChildProfiles(true,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("switchToSingletonChildProfile()", 2, function() {
            bc.identity.switchToSingletonChildProfile(
                    CHILD_APP_ID,
                    true,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("runParentScript()", 2, function() {
            bc.script.runParentScript(scriptName,
                    scriptData, PARENT_LEVEL_NAME, function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("detachParent()", 2, function() {
            bc.identity.detachParent(function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("attachParentWithIdentity()", 2, function() {
            bc.identity.attachParentWithIdentity(
                UserA.name, UserA.password,
                bc.identity.authenticationType.universal,
                null, true,
                function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("switchToParentProfile()", 2, function() {
            bc.identity.switchToParentProfile(PARENT_LEVEL_NAME,
                    function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("attachPeerProfile()", 2, function() {
            bc.identity.attachPeerProfile(
                PEER_NAME,UserA.name, UserA.password,
                bc.identity.authenticationType.universal,
                 null, true,
                function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("detachPeer()", 2, function() {
            bc.identity.detachPeer(
                PEER_NAME,
                function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("getPeerProfiles()", 2, function() {
            bc.identity.getPeerProfiles(
                function(result) {
                        ok(true, JSON.stringify(result));
                        equal(result.status, 200, "Expecting 200");
                        start();
                    });
        });

        asyncTest("logout()", function() {
            bc.playerState.logout(function(result) {
                equal(result.status, 200, JSON.stringify(result));
                start();
            });
        });
    }

    ////////////////////////////////////////
    // Comms unit tests
    ////////////////////////////////////////
    function testComms() {
        module("Comms", null);

        asyncTest("readServerTime()", function() {
            bc.time.readServerTime(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 403, "Expecting 403");
                equal(result.reason_code, 40304, "Expecting 40304 - NO_SESSION");
                start();
            });
        });

        asyncTest("authenticateUniversal()", function() {
            bc.brainCloudClient.authentication.authenticateUniversal(UserA.name,
                    UserA.password, true, function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("readServerTime()", function() {
            bc.time.readServerTime(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("Timeout test", 2, function() {
            bc.time.readServerTime(function(result) {
                console.log("Waiting for session to timeout...")
                setTimeout(function() {
                    ok(true, JSON.stringify(result));
                    equal(result.status, 200, "Expecting 200");
                    start();
                }, 61 * 1000)
            });
        });

        asyncTest("Timeout test P2", function() {
            bc.time.readServerTime(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 403, "Expecting 403");
                equal(result.reason_code, 40303, "Expecting 40303");
                start();
            });
        });

        asyncTest("Timeout test P3", function() {
            bc.time.readServerTime(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 403, "Expecting 403");
                equal(result.reason_code, 40303, "Expecting 40303");
                start();
            });
        });

        asyncTest("authenticateUniversal()", function() {
            bc.brainCloudClient.authentication.authenticateUniversal(UserA.name,
                    UserA.password, true, function(result) {
                        equal(result.status, 200, JSON.stringify(result));
                        start();
                    });
        });

        asyncTest("readServerTime()", function() {
            bc.time.readServerTime(function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });
    }

    ////////////////////////////////////////
    // File unit tests
    ////////////////////////////////////////
    function testFile() {
        module("File", null);

        asyncTest("listUserFiles(\"\", true)", function() {
            bc.file.listUserFiles("", true, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("listUserFiles(null, null)", function() {
            bc.file.listUserFiles(null, null, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("deleteUserFile()", function() {
            bc.file.deleteUserFile(null, null, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });

        asyncTest("deleteUserFiles()", function() {
            bc.file.deleteUserFiles("", true, function(result) {
                ok(true, JSON.stringify(result));
                equal(result.status, 200, "Expecting 200");
                start();
            });
        });
    }

    ////////////////////////////////////////
    // Wrapper unit tests
    ////////////////////////////////////////
    function testWrapper()
    {
        module("Wrapper", null);

        // we want to log debug messages
        bc.brainCloudClient.setDebugEnabled(true);

        //initialize with our game id, secret and game version
        bc.initialize(GAME_ID, SECRET, GAME_VERSION);

        // point to internal (default is sharedprod)
        bc.brainCloudClient.setServerUrl(SERVER_URL);

        bc.brainCloudClient.useJQuery(true);


		asyncTest("authenticateAnonymous()", function() {
			bc.authenticateAnonymous(function(result) {
				ok(true, JSON.stringify(result));
				equal(result.status, 200, "Expecting 200");
				start();
			});
		});


		asyncTest("smartSwitchFromNoAuth()", function() {

			bc.brainCloudClient.authentication.generateNewAnonymousId();
			bc.brainCloudClient.authentication.clearSavedProfileId();

			if(bc.brainCloudClient.isAuthenticated()) {
				bc.brainCloudClient.playerState.logout(()=> {
					bc.smartSwitchAuthenticateUniversal(
						UserA.name,
						UserA.password,
						true,
						function(result) {
							ok(true, JSON.stringify(result));
							equal(result.status, 200, "Expecting 200");
							start();
						});
                });
            } else {
				bc.smartSwitchAuthenticateUniversal(
					UserA.name,
					UserA.password,
					true,
					function(result) {
						ok(true, JSON.stringify(result));
						equal(result.status, 200, "Expecting 200");
						start();
					});
            }


		});


		asyncTest("smartSwitchFromAnon()", function() {

			bc.brainCloudClient.authentication.generateNewAnonymousId();
			bc.brainCloudClient.authentication.clearSavedProfileId();

			bc.brainCloudClient.authentication.authenticateAnonymous(
				true, function(result) {

					console.log(bc.brainCloudClient.authentication.anonymousId);
					console.log(bc.brainCloudClient.authentication.profileId);

					bc.setStoredProfileId("");
					bc.setStoredAnonymousId("");

					bc.brainCloudClient.authentication.anonymousId = "";
					bc.brainCloudClient.authentication.profileId = "";

					bc.smartSwitchAuthenticateUniversal(
						UserA.name,
						UserA.password,
						true,
						function(result) {
							ok(true, JSON.stringify(result));
							equal(result.status, 200, "Expecting 200");
                            start();
						});

				});

        });


		asyncTest("smartSwitchFromAuth()", function() {

			bc.brainCloudClient.authentication.generateNewAnonymousId();
			bc.brainCloudClient.authentication.clearSavedProfileId();

			bc.brainCloudClient.authentication.authenticateEmailPassword(UserA.email, UserA.password,
				true, function(result) {

					console.log(bc.brainCloudClient.authentication.anonymousId);
					console.log(bc.brainCloudClient.authentication.profileId);

					bc.setStoredProfileId("");
					bc.setStoredAnonymousId("");

					bc.brainCloudClient.authentication.anonymousId = "";
					bc.brainCloudClient.authentication.profileId = "";

					bc.smartSwitchAuthenticateUniversal(
						UserA.name,
						UserA.password,
						true,
						function(result) {
							ok(true, JSON.stringify(result));
							equal(result.status, 200, "Expecting 200");
							start();
						});

				});

		});

    }

    testKillSwitch();
    testAsyncMatch();
    testAuthentication();
    testDataStream();
    testEntity();
    testEvent();
    testFriend();
    testGamification();
    testGlobalApp();
    testGlobalStatistics();
    testGlobalEntity();
    testGroup();
    testIdentity();
    testMail();
    testMatchMaking();
    testOneWayMatch();
    testPlaybackStream();
    testPlayerState();
    testPlayerStatisticsEvent();
    testPlayerStatistics();
    testProduct();
    testProfanity();
    testPushNotification();
    testRedemptionCode();
    testS3Handling();
    testScript();
    testSocialLeaderboard();
    testTime();
    testTournament();
    testSharedIdentity();
    testComms();
    testFile();
    testWrapper();

</script>
</head>
<body>
 <div id="qunit"></div>
</body>
</html>
